# Implementation Plan

## Фаза 1: Основа модульного редактора

- [x] 1. Создать систему логирования канваса


  - Создать CanvasLogger.ts с методами для записи действий
  - Реализовать очистку лога при запуске приложения
  - Добавить типы для различных действий на канвасе
  - Интегрировать логирование в основные действия редактора
  - _Requirements: 3_

- [x] 2. Реализовать базовую структуру мульти-узла




  - Создать компонент MultiNode.tsx с поддержкой расширения
  - Добавить треугольную кнопку NodeExpander.tsx для сворачивания/разворачивания
  - Реализовать хранение состояния расширения узлов



  - Создать базовые стили для мульти-узлов
  - _Requirements: 1_

- [x] 3. Создать систему портов подключения с индикацией









  - Реализовать компонент ConnectionPorts.tsx
  - Добавить цветную индикацию портов (синий - доступен, красный - занят)
  - Создать подсказки при наведении на порты
  - Интегрировать с существующей системой соединений ReactFlow
  - _Requirements: 6_



- [ ] 4. Разработать анализатор частоты использования компонентов
  - Создать UsageAnalyzer.ts для отслеживания статистики
  - Реализовать сохранение/загрузку статистики в localStorage
  - Добавить методы для категоризации компонентов по популярности
  - Создать интерфейсы для данных статистики


  - _Requirements: 2_









- [ ] 5. Создать систему единого рендеринга узлов
  - Создать UnifiedNodeRenderer.tsx для отображения узлов в витрине и на канвасе
  - Реализовать NodeRegistry.ts как единый реестр конфигураций узлов
  - Создать NodePreviewGenerator.tsx для генерации превью в витрине
  - Обеспечить полное соответствие внешнего вида узлов между витриной и канвасом
  - _Requirements: 13_




- [ ] 6. Создать умную витрину компонентов
  - Реализовать SmartLibrary.tsx с категориями по популярности
  - Добавить секции "Часто используемые", "Средне используемые", "Редко используемые"
  - Интегрировать с анализатором использования и единым рендерером узлов
  - Сохранить совместимость с существующим drag&drop
  - _Requirements: 2, 13_


## Фаза 2: Система группировки

- [ ] 7. Реализовать цветные зоны для группировки узлов
  - Создать компонент ColorZones.tsx для визуального выделения групп
  - Добавить палитру цветов для групп
  - Реализовать выделение нескольких узлов для группировки
  - Создать возможность изменения цвета группы
  - _Requirements: 7_

- [ ] 8. Создать систему складных групп


  - Реализовать компонент FoldableGroups.tsx
  - Добавить возможность сворачивания/разворачивания групп
  - Создать компактное представление свернутых групп
  - Реализовать сохранение позиций узлов при разворачивании
  - _Requirements: 8_

- [x] 9. Добавить валидацию с цветными рамками

  - Создать компонент ValidationFrames.tsx
  - Реализовать цветные рамки: красная (ошибка), зеленая (ОК), желтая (предупреждение)
  - Интегрировать с существующей системой валидации SchemaValidator
  - Добавить подсказки с описанием ошибок при наведении
  - _Requirements: 9_

## Фаза 3: Система навигации и связей



- [ ] 10. Создать двунаправленные стрелки навигации
  - Реализовать компонент BidirectionalEdge.tsx
  - Добавить визуальное отображение двунаправленных связей
  - Создать возможность навигации в обе стороны по связям
  - Интегрировать с существующей системой edges ReactFlow
  - _Requirements: 4_

- [ ] 11. Реализовать разные типы стрелок для связей
  - Создать компонент EdgeTypes.tsx с различными типами стрелок
  - Добавить стрелки для обычных связей, условий, ошибок
  - Реализовать автоматический выбор типа стрелки по контексту
  - Создать стили для различных типов стрелок
  - _Requirements: 10_

- [ ] 12. Добавить подписи на стрелках связей
  - Создать компонент EdgeLabels.tsx для отображения подписей
  - Реализовать сокращение длинных подписей с многоточием
  - Добавить полные подсказки при наведении курсора
  - Создать возможность редактирования подписей связей
  - _Requirements: 11_

- [ ] 13. Реализовать варианты расположения кнопок в узлах
  - Добавить настройку расположения кнопок: сверху, снизу, сбоку
  - Модифицировать существующие узлы для поддержки разных макетов
  - Создать UI для выбора расположения кнопок
  - Обновить стили узлов для всех вариантов расположения
  - _Requirements: 12_

## Интеграция и тестирование

- [ ] 14. Интегрировать все модули в основной редактор
  - Обновить Editor.tsx для использования новых модулей
  - Заменить NodeLibrary на SmartLibrary
  - Интегрировать систему логирования во все компоненты
  - Обеспечить совместимость с существующими функциями
  - _Requirements: 5_

- [ ] 15. Создать тесты для новых модулей
  - Написать unit-тесты для каждого нового компонента
  - Создать интеграционные тесты для взаимодействия модулей
  - Добавить тесты для системы логирования
  - Протестировать drag&drop функциональность
  - _Requirements: 5_

- [ ] 16. Оптимизировать производительность и отладку
  - Оптимизировать рендеринг мульти-узлов
  - Добавить lazy loading для редко используемых компонентов
  - Создать инструменты для просмотра логов разработчиком
  - Провести тестирование производительности на больших схемах
  - _Requirements: 3, 5_