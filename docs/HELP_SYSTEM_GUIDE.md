# Руководство по системе помощи и документации

## Обзор

Система помощи предоставляет контекстные подсказки, примеры использования и решения типичных проблем для всех блоков конструктора ботов. Она интегрирована в визуальный редактор и доступна через API.

## Основные возможности

### 1. Контекстная справка по узлам
- Подробное описание каждого типа узла
- Примеры конфигурации с разными уровнями сложности
- Лучшие практики использования
- Решения типичных проблем

### 2. Поиск по документации
- Полнотекстовый поиск по всей справочной системе
- Фильтрация по типу контента (узлы, шаблоны, примеры)
- Фильтрация по категориям и уровню сложности
- Ранжирование результатов по релевантности

### 3. Рекомендации
- Автоматические рекомендации узлов для решения задач
- Учет специфики платформ мессенджеров
- Связанные узлы и альтернативные решения

## Архитектура системы

### Backend компоненты

#### HelpSystem.ts
Основной класс системы помощи:
```typescript
export class HelpSystem {
  getNodeHelp(nodeType: string): NodeHelpInfo | null
  search(query: string, filters?: SearchFilters): SearchResult[]
  getNodeExamples(nodeType: string, difficulty?: string): NodeExample[]
  getRelatedNodes(nodeType: string): NodeHelpInfo[]
  getRecommendations(task: string, platform?: string): SearchResult[]
}
```

#### API роуты (/api/help)
- `GET /nodes/:nodeType` - получить справку по узлу
- `GET /search?q=query` - поиск по документации
- `GET /nodes/:nodeType/examples` - примеры для узла
- `GET /nodes/:nodeType/related` - связанные узлы
- `POST /recommendations` - рекомендации для задачи
- `GET /categories` - список всех категорий

### Frontend компоненты

#### HelpSystem.tsx
React компонент системы помощи:
```typescript
interface HelpSystemProps {
  selectedNodeType?: string;
  onClose?: () => void;
  isVisible: boolean;
}
```

Включает:
- Поисковую строку с автодополнением
- Табы для разных типов информации
- Интерактивные примеры кода
- Навигацию по связанным узлам

## Структура данных справки

### NodeHelpInfo
```typescript
interface NodeHelpInfo {
  id: string;                    // Уникальный ID узла
  title: string;                 // Название узла
  description: string;           // Подробное описание
  category: string;              // Категория (triggers, actions, etc.)
  examples: NodeExample[];       // Примеры использования
  bestPractices: string[];       // Лучшие практики
  commonIssues: CommonIssue[];   // Типичные проблемы и решения
  relatedNodes: string[];        // Связанные узлы
  platforms: string[];           // Поддерживаемые платформы
}
```

### NodeExample
```typescript
interface NodeExample {
  title: string;                 // Название примера
  description: string;           // Описание
  config: Record<string, any>;   // Конфигурация узла
  useCase: string;               // Сценарий использования
  difficulty: 'beginner' | 'intermediate' | 'advanced';
}
```

### CommonIssue
```typescript
interface CommonIssue {
  problem: string;               // Описание проблемы
  solution: string;              // Решение
  prevention: string;            // Как избежать проблемы
}
```

## Использование в интерфейсе

### Открытие справки
1. Кнопка "❓" в заголовке редактора
2. Автоматическое открытие при выборе узла
3. Контекстное меню узла

### Навигация
- **Обзор**: основная информация и лучшие практики
- **Примеры**: готовые конфигурации с объяснениями
- **Проблемы**: типичные ошибки и их решения
- **Связанные**: рекомендуемые узлы для комбинирования

### Поиск
- Введите запрос в поисковую строку
- Используйте фильтры для уточнения результатов
- Кликните на результат для перехода к справке

## Добавление новых узлов в справку

### 1. Обновите HelpSystem.ts
```typescript
private initializeNodeHelp(): void {
  this.nodeHelp.set('your-node-type', {
    id: 'your-node-type',
    title: 'Название узла',
    description: 'Подробное описание функциональности',
    category: 'actions', // или другая категория
    examples: [
      {
        title: 'Базовый пример',
        description: 'Описание примера',
        config: { /* конфигурация */ },
        useCase: 'Когда использовать',
        difficulty: 'beginner'
      }
    ],
    bestPractices: [
      'Рекомендация 1',
      'Рекомендация 2'
    ],
    commonIssues: [
      {
        problem: 'Описание проблемы',
        solution: 'Как решить',
        prevention: 'Как избежать'
      }
    ],
    relatedNodes: ['related-node-1', 'related-node-2'],
    platforms: ['telegram', 'max'] // или ['all']
  });
}
```

### 2. Обновите mock данные в routes/help.js
Добавьте аналогичную структуру в `mockHelpData`.

### 3. Добавьте тесты
Обновите `src/test-help-system.ts` для проверки нового узла.

## Лучшие практики написания справки

### Описания
- Начинайте с краткого определения функции узла
- Объясняйте когда и зачем использовать узел
- Указывайте ограничения и особенности

### Примеры
- Начинайте с простых случаев использования
- Постепенно усложняйте примеры
- Показывайте реальные сценарии применения
- Объясняйте каждый параметр конфигурации

### Лучшие практики
- Давайте конкретные, действенные советы
- Объясняйте "почему", а не только "как"
- Предупреждайте о потенциальных проблемах

### Типичные проблемы
- Описывайте реальные ошибки пользователей
- Давайте четкие инструкции по решению
- Объясняйте как избежать проблемы в будущем

## Интеграция с другими системами

### Связь с валидацией
Система помощи интегрирована с валидатором схем:
- Ошибки валидации содержат ссылки на справку
- Рекомендации учитывают правила валидации

### Связь с шаблонами
- Шаблоны ботов ссылаются на справку по узлам
- Справка содержит примеры из шаблонов

### Связь с тестированием
- Примеры в справке используются в автотестах
- Тесты проверяют актуальность справочной информации

## Производительность

### Кэширование
- Справочные данные кэшируются в памяти
- Поисковый индекс строится один раз при запуске
- Результаты поиска кэшируются на клиенте

### Оптимизация поиска
- Индексация по ключевым словам
- Ограничение количества результатов
- Ранжирование по релевантности

## Мониторинг и аналитика

### Метрики использования
- Частота обращений к справке по узлам
- Популярные поисковые запросы
- Время, проведенное в справочной системе

### Обратная связь
- Возможность оценить полезность справки
- Предложения по улучшению
- Отчеты об ошибках в документации

## Планы развития

### Ближайшие улучшения
- Интерактивные примеры с возможностью тестирования
- Видео-туториалы для сложных узлов
- Персонализированные рекомендации

### Долгосрочные планы
- ИИ-помощник для генерации справки
- Автоматическое обновление примеров
- Интеграция с системой обучения

## Troubleshooting

### Справка не загружается
1. Проверьте доступность API `/api/help`
2. Убедитесь что роут подключен в server.js
3. Проверьте консоль браузера на ошибки

### Поиск не работает
1. Проверьте индексацию данных в HelpSystem
2. Убедитесь что поисковые запросы корректно обрабатываются
3. Проверьте фильтры поиска

### Примеры не отображаются
1. Проверьте структуру данных NodeExample
2. Убедитесь что JSON корректно сериализуется
3. Проверьте CSS стили для примеров

## Заключение

Система помощи является ключевым компонентом пользовательского опыта в конструкторе ботов. Она помогает пользователям быстро освоить функциональность и эффективно решать задачи. Регулярное обновление и улучшение справочной информации критически важно для успеха продукта.