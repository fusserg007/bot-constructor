<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        button { margin: 5px; padding: 10px; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Bot Constructor</h1>
    
    <div class="test-section">
        <h2>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ JavaScript</h2>
        <div id="js-test">‚ùå JavaScript –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</div>
    </div>
    
    <div class="test-section">
        <h2>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ API</h2>
        <button onclick="testAPI()">–¢–µ—Å—Ç API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</button>
        <div id="api-test"></div>
    </div>
    
    <div class="test-section">
        <h2>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π</h2>
        <button onclick="testBackToDashboard()">–¢–µ—Å—Ç –∫–Ω–æ–ø–∫–∏ –ù–∞–∑–∞–¥</button>
        <button onclick="testBackButton()">–í—ã–∑–≤–∞—Ç—å backToDashboard()</button>
        <div id="function-test"></div>
    </div>
    
    <div class="test-section">
        <h2>4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤</h2>
        <button onclick="testElements()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã</button>
        <div id="elements-test"></div>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ JavaScript
        document.getElementById('js-test').innerHTML = '‚úÖ JavaScript –∑–∞–≥—Ä—É–∂–µ–Ω';
        document.getElementById('js-test').className = 'success';
        
        async function testAPI() {
            const result = document.getElementById('api-test');
            try {
                const response = await fetch('/api/stats/dashboard');
                const data = await response.json();
                result.innerHTML = `‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç:<br><pre>${JSON.stringify(data, null, 2)}</pre>`;
                result.className = 'success';
            } catch (error) {
                result.innerHTML = `‚ùå –û—à–∏–±–∫–∞ API: ${error.message}`;
                result.className = 'error';
            }
        }
        
        function testBackToDashboard() {
            const result = document.getElementById('function-test');
            try {
                let html = '';
                
                if (typeof window.backToDashboard === 'function') {
                    html += '‚úÖ –§—É–Ω–∫—Ü–∏—è backToDashboard –Ω–∞–π–¥–µ–Ω–∞<br>';
                } else {
                    html += '‚ùå –§—É–Ω–∫—Ü–∏—è backToDashboard –Ω–µ –Ω–∞–π–¥–µ–Ω–∞<br>';
                }
                
                if (typeof window.debugApp === 'function') {
                    html += '‚úÖ –§—É–Ω–∫—Ü–∏—è debugApp –Ω–∞–π–¥–µ–Ω–∞<br>';
                    window.debugApp(); // –í—ã–∑—ã–≤–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
                } else {
                    html += '‚ùå –§—É–Ω–∫—Ü–∏—è debugApp –Ω–µ –Ω–∞–π–¥–µ–Ω–∞<br>';
                }
                
                if (window.botConstructor) {
                    html += '‚úÖ window.botConstructor –Ω–∞–π–¥–µ–Ω<br>';
                    html += `- currentView: ${window.botConstructor.currentView || '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}<br>`;
                    html += `- currentBot: ${window.botConstructor.currentBot?.name || '–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω'}<br>`;
                } else {
                    html += '‚ùå window.botConstructor –Ω–µ –Ω–∞–π–¥–µ–Ω<br>';
                }
                
                result.innerHTML = html;
                result.className = 'success';
            } catch (error) {
                result.innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                result.className = 'error';
            }
        }
        
        function testElements() {
            const result = document.getElementById('elements-test');
            const elements = [
                'dashboard-view',
                'constructor-view',
                'totalBots',
                'activeBots',
                'botsContainer'
            ];
            
            let html = '';
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    html += `‚úÖ ${id} –Ω–∞–π–¥–µ–Ω<br>`;
                } else {
                    html += `‚ùå ${id} –Ω–µ –Ω–∞–π–¥–µ–Ω<br>`;
                }
            });
            
            result.innerHTML = html;
        }
        
        function testBackButton() {
            const result = document.getElementById('function-test');
            try {
                if (typeof window.backToDashboard === 'function') {
                    result.innerHTML += '<br>üîÑ –í—ã–∑—ã–≤–∞–µ–º backToDashboard()...<br>';
                    window.backToDashboard();
                    result.innerHTML += '‚úÖ –§—É–Ω–∫—Ü–∏—è –≤—ã–∑–≤–∞–Ω–∞ –±–µ–∑ –æ—à–∏–±–æ–∫<br>';
                } else {
                    result.innerHTML += '‚ùå –§—É–Ω–∫—Ü–∏—è backToDashboard –Ω–µ –Ω–∞–π–¥–µ–Ω–∞<br>';
                }
            } catch (error) {
                result.innerHTML += `‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ: ${error.message}<br>`;
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(() => {
                testAPI();
                testBackToDashboard();
                testElements();
            }, 1000);
        });
    </script>
</body>
</html>